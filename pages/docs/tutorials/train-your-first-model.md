# Train your first model

[TOC]

In this tutorial we'll train two models using the MNIST
dataset. Training models with Guild AI is a simple process of finding
a model, installing it, and running the []($cmd train) command.

## Requirements

This tutorial assumes the following:

- Guild AI is [installed](/install) and [verified by running
  `check`](/install#verify-your-installation)
- If applicable, your Guild [virtual environment is
  active->]($virtualenv-activate)
- You have a working Internet connection

## Find the MNIST package

We'll start by searching for MNIST models. In a console, run:

``` shell
guild search mnist
```

You should see a list of [packages]($term package) that include one
named `mnist`. This package is provided as a sample and includes the
models used in TensorFlow's [Getting
Started->](https://www.tensorflow.org/get_started/) guide.

!!! note
    Guild's []($cmd search) command is used to find a wealth of packaged
    models, not just MNIST! Look for it in the [other
    tutorials](/docs/tutorials).

## Install the MNIST package

Before training the MNIST models, we need to install the package. In a
console, run:

``` shell
guild install mnist
```

This command will download and install the `mnist` package on your
system.

You can list the installed packages by running:

``` shell
guild packages
```

Packages provide [models]($term model). You can list the installed models by running:

``` shell
guild models
```

The `mnist` package provides two models:

- **softmax** -- softmax regression classifier for MNIST
- **cnn** -- CNN classifier for MNIST

Each model in turn provides [operations]($term operation). Operations
are run using Guild's []($cmd run) command.

You can list the available operations by running:

``` shell
guild operations
```

!!! note
    You can just run `guild ops` as a shortcut rather than typing
    the full command.

Note that the two MNIST models provides a `train`
operation. Operations are listed in the form
`PACKAGE/MODEL:OPERATION`. For more information, refer to
[*Packages*](/docs/packages/), [*Models*](/docs/models/), and
[*Operations*](/docs/operations/).

That it, we're ready to train!

## Train the softmax model

In a console, run:

``` shell
guild train softmax
```

You will be prompted with informatio about the run and asked to
confirm the operation. The model defines two [flags]($term flag):

- `batch-size` - the number of images to use per batch
- `epochs` - the number of eppchs to train

Accept the default values by pressing ENTER to continue.

The operation will first satisfy any required resources (e.g. by
downloading them) and then run a TensorFlow script to train the
`softmax` model.

As the model trains, let's note a few things:

- The model requires an MNIST []($term dataset), which is automatically
  downloaded and saved by Guild as a []($term resource). This resource
  will remain available for subsequent training operations that use
  the MNIST dataset.

- Guild starts and supervises a TensorFlow script, which is provided
  by the `mnist` package. Scripts are standard Python applications
  that require little to no modification for use in Guild.

- Guild creates a unique [run directory]($term run-directory) that is
  associated with the training operation. This directory contains the
  output generated by the training script.

Once the datset files are downloaded, the model should be fully
trained in a few seconds on most systems.

Congratulations, you've trained your first Guild model!

Let's take a look at what was generated.

## Examine your training run

Guild operations generate [runs]($term run). You can list runs using
this command:

``` shell
guild runs
```

This will display the training run for the softmax model. You can see
when the operation was started and its status.

To get more information for a run, use this command:

``` shell
guild runs info
```

This will display detailed information for the latest run. You can
alternatively use the run index:

``` shell
guild runs info 0
```

The value `0` is the run index as displayed in the latest `guild runs`
command. It is always associated with the latest matching run.

Information associated with a run includes:

- Run ID
- Status
- Start and stop times
- Run directory
- Operation command
- Exit status

Guild operations typically generate files, which are located in the
run directory. You can list the files by including the `--files`
option to the `runs info` command:

``` shell
guild runs info --files
```

## Visualizing runs

``` shell
guild view
```

TODO cur:

- Use view to visualize the run, including files
- Use tensorboard to visualize the run

---

TODO next:

- Training the cnn
- Getting info about that run
- Comparing runs
- Viewing runs in TensorBoard
- Doing something with the output
  - Evaluate/test
  - Deploy - Cloud ML, serving, internal server
  - Publish the results (output from compare?)
- Summary
- Next steps
