tags: tutorial, popular, intro

# Train your first model

[TOC]

In this tutorial we'll train two models with [MNIST data
->](http://yann.lecun.com/exdb/mnist/). Training models with Guild AI
is a simple process of finding a model, installing it, and running
`train`!

## Requirements

This tutorial assumes the following:

- Guild AI is [installed and verified](/install)
- Your [virtual environment is activated](alias:virtualenv-activate)
  (if applicable)
- You have a working Internet connection

## Find the MNIST package

We'll start by searching for MNIST models. In a console, run:

``` shell
guild search mnist
```

You should see a list of [packages](term:package) that include one
named `mnist`. This package is provided as a sample and includes the
models used in TensorFlow's [Getting Started
->](https://www.tensorflow.org/get_started/).

!!! note
    Guild's [](cmd:search) command is used to find a wealth of packaged
    models, not just MNIST! Look for it in the [other
    tutorials](/docs/tutorials).

## Install the MNIST package

Before training the MNIST models, we need to install the package. In a
console, run:

``` shell
guild install mnist
```

This command will download and install the `mnist` package on your
system.

You can list the installed packages by running:

``` shell
guild packages
```

Packages provide [models](term:model). You can list the installed models by running:

``` shell
guild models
```

The `mnist` package provides two models:

- `softmax` -- softmax regression classifier for MNIST
- `cnn` -- CNN classifier for MNIST

Each model in turn provides [operations](term:operation). Operations
are run using Guild's [](cmd:run) command.

You can list the available operations by running:

``` shell
guild operations
```

!!! note
    You can just run ``guild ops`` as a shortcut rather than typing
    the full command.

Note that the two MNIST models provides a `train`
operation. Operations are listed in the form
``PACKAGE/MODEL:OPERATION``. For more information, refer to
[*Packages*](/docs/packages/), [*Models*](/docs/models/), and
[*Operations*](/docs/operations/).

We're ready to train!

## Train the softmax model

In a console, run:

``` shell
guild train softmax
```

You will be prompted with informatio about the run and asked to
confirm the operation. The model defines two [flags](term:flag):

- `batch-size` - the number of images to use per batch
- `epochs` - the number of eppchs to train

Accept the default values by pressing `ENTER` to continue.

The operation will first satisfy any required resources (e.g. by
downloading them) and then run a TensorFlow script to train the
`softmax` model.

!!! aside

    As the model trains, let's note a few things:

    - The model requires an MNIST dataset, which is automatically
      downloaded and saved by Guild as a [](term:resource). This resource
      will remain available for subsequent training operations that require
      the MNIST dataset.

    - Guild starts and supervises a TensorFlow script, which is provided
      by the `mnist` package. Scripts are standard Python applications
      that require little to no modification for use in Guild.

    - Guild creates a unique [run directory](term:run-dir) that is
      associated with the training operation. This directory contains the
      output generated by the training script.

    You'll learn more in the steps that follow!

Once the datset files are downloaded, the model will fully train in a
few seconds on most systems.

Congratulations, you've trained your first Guild model!

## Examine your training run

Guild operations produce [runs](term:run), which are artifacts that
are available for inspection during and after the operation. You can
list runs:

``` shell
guild runs
```

This will display the training run for the `softmax` model. You can
see when the operation was started and its status.

To get more information for a run:

``` shell
guild runs info
```

This will display detailed information for the latest run. You can
alternatively use the run index:

``` shell
guild runs info 0
```

The value `0` is the run index as displayed in the latest ``guild
runs`` command. `0` is always associated with the latest matching run.

Guild operations typically generate files, which are located in the
run directory. You can list the files by including the ``--files``
option:

``` shell
guild runs info --files
```

Next we'll use Guild's visual tools to look more closely at the run.

## Visualizing runs

Guild provides two visualization tools:

- [Guild View](/docs/visual/guild-view/)
- [TensorBoard](/docs/visual/tensorboard/)

Guild View is useful for browsing run details and viewing generating
artifacts. TensorBoard is a tool created by the TensorFlow
contributors for visualizing training logs.

Let's start with Guild View. In a [](alias:separate-console), run:

``` shell
guild view
```

TODO cur:

- Use view to visualize the run, including files
- Use tensorboard to visualize the run

---

TODO next:

- Training the cnn
- Getting info about that run
- Comparing runs
- Viewing runs in TensorBoard
- Doing something with the output
  - Evaluate/test
  - Deploy - Cloud ML, serving, internal server
  - Publish the results (output from compare?)
- Summary
- Next steps
