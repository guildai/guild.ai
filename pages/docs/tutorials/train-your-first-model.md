tags: tutorial, popular, intro

# Train your first model

[TOC]

In this tutorial we'll train two models with [MNIST data
->](http://yann.lecun.com/exdb/mnist/). Training models with Guild AI
is a simple process of finding a model, installing it, and running
the `train` command.

## Requirements

This tutorial assumes the following:

- Guild AI is [installed and verified](/install)
- Your [virtual environment is activated](alias:virtualenv-activate)
  (if applicable)
- You have a working Internet connection

## Find the MNIST package

Start by searching for MNIST models. [In a
console](alias:running-commands), run:

``` command
guild search mnist
```

You should see a list of [packages](term:package) that includes
`mnist`. This package is provided as a sample and contains simple
models that train quickly.

## Install the MNIST package

To install the `mnist` package, run:

``` command
guild install mnist
```

This command downloads and installs `mnist` on your system.

When the install has completed, list the installed packages:

``` command
guild packages
```

A package provides [models](term:model). You can list the installed
models by running:

``` command
guild models
```

The command output will contain two models associated with the `mnist`
package:

``` output
mnist/mnist-cnn      CNN classifier for MNIST
mnist/mnist-softmax  Softmax regression classifier for MNIST
```

Models are displayed in the list with their packages as
`PACKAGE/MODEL`.

Each model provides [operations](term:operation), which, when run,
perform actions associated with the model.

List the available operations by running:

``` command
guild operations
```

!!! note
    You can run ``guild ops`` as a shortcut ``guild operations``.

The two models each provide a `train` operation:

``` output
mnist/mnist-cnn:train      Train the CNN
mnist/mnist-softmax:train  Train the softmax regression
```

Operations are displayed in the list with their models as
`PACKAGE/MODEL:OPERATION`.

For more information, see:

- [Packages](/docs/packages/)
- [Models](/docs/models/)
- [Operations](/docs/operations/)

Next, we'll train one of the models by running its `train` operation.

## Train the softmax model

In a console, run:

``` command
guild train mnist-softmax
```

You will be prompted with information about the run and asked to
confirm the operation. The model defines two [flags](term:flag):

batch-size
: number of images to use per batch

epochs
: number of epochs to train

Press `ENTER` to accept the default values and to continue.

The operation will first resolve any resources required by the model
by downloading them and then run a TensorFlow script to train the
`mnist-softmax` model.

As the model trains, let's note a few things:

- The model requires an MNIST dataset, which is automatically
  downloaded and saved by Guild as a [](term:resource). This resource
  will remain available for future training operations.

- Guild starts and supervises a TensorFlow script, which is provided
  by the `mnist` package. Scripts are standard Python applications
  that require little to no modification for use in Guild.

- Guild creates a unique [run directory](term:run-dir) that is
  associated with the training operation. This directory contains the
  output generated by the training script.

You'll learn more in the steps that follow!

Once the dataset files are downloaded, the model will fully train in a
few seconds on most systems.

Congratulations, you've trained your first Guild model!

## Examine your training run

Guild operations produce [runs](term:run), which are artifacts that
are available for inspection during and after the operation. You can
list runs:

``` command
guild runs
```

This will display the training run for the `mnist-softmax` model. You
can see when the operation was started and its status.

To get more information for a run:

``` command
guild runs info
```

This will display detailed information for the latest run. You can
alternatively use the run index:

``` command
guild runs info 0
```

The value `0` is the run index as displayed in the latest ``guild
runs`` command. `0` is always associated with the latest matching run.

Guild operations typically generate files, which are located in the
run directory. You can list the files by including the ``--files``
option:

``` command
guild runs info --files
```

Next we'll use Guild's visual tools to look more closely at the run.

## Visualizing runs

Guild provides two visualization tools:

- [Guild View](/docs/visual/guild-view/)
- [TensorBoard](/docs/visual/tensorboard/)

Guild View is useful for browsing run details and viewing generating
artifacts. TensorBoard is a tool created by the TensorFlow
contributors for visualizing training logs.

### Guild View

Let's start with Guild View. In a [](alias:separate-console), run:

``` command
guild view
```

Guild View will start and will open a browser window. You should see
something like this:

![Guild View](/assets/img/guild-view-1.png)

^ Guild View after initial training of MNIST `mnist-softmax` model

Take a moment to explore the information provided. Click the `FILES`
tab to view the files associated with the run.

### TensorBoard

TensorBoard is integrated into Guild in two ways:

- Link from Guild View
- Standalone [](cmd:tensorboard) command

Since we have have Guild View running, let's use the integrated link
to open TensorBoard. In the upper-left corner of Guild View, click
this link:

![View in TensorBoard](/assets/img/view-in-tensorboard.png)

This will open TensorBoard in a separate tab that displays the
TensorFlow logs for the MNIST `mnist-softmax` run.

Keep Guild View and TensorBoard open running in your browser
throughout the remained of this tutorials --- they will both update
automatically as you continue to work!

## Train the CNN model

As we saw earlier, the MNIST package contains two models:
`mnist-softmax` and `mnist-cnn`.

Let's review the operations available to run. We'll use the shortcut
`ops` this time:

``` command
guild ops
```

Here's the output:

``` output
mnist/mnist-cnn:train      Train the CNN
mnist/mnist-softmax:train  Train the softmax regression
```

Let's take a moment to understand this output. Operations are
presented in the form:

    PACKAGE/MODEL:OPERATION

Operations are run using the [](cmd:run) command:

``` command
guild run MODEL:OPERATION
```

The [](cmd:train) command, which we used earlier to train the softmax
model, is short-hand for running the `train` operation:

``` command
guild run MODEL:train
```

Guild provides the `train` command because the operation is so common.

---

TODO next:

- Training the cnn
- Getting info about that run
- Comparing runs
- Viewing runs in TensorBoard
- Doing something with the output
  - Evaluate/test
  - Deploy - Cloud ML, serving, internal server
  - Publish the results (output from compare?)
- Summary
- Next steps
